# Chrome拡張機能企画書：タスク作業時間自動計算ツール

## 1. 概要

### 1.1 目的
バックログやGitHubのタスクのステータス変更を自動検知し、指定されたステータス間での作業時間を自動計算するChrome拡張機能を開発する。

### 1.2 対象サービス
- バックログ（Backlog）
- GitHub Issues/Projects

## 2. 機能要件

### 2.1 コア機能
- **自動ステータス検知**: タスクのステータス変更を自動で監視
- **作業時間計算**: 指定されたステータス間の経過時間を自動計算
- **時間記録**: 計算された時間をローカルストレージに保存
- **レポート表示**: 日次/週次/月次の作業時間サマリーを表示

### 2.2 設定機能
- **対象ステータス設定**: 計算対象とするステータスの開始/終了を設定
- **除外時間設定**: 休憩時間や非作業時間の除外ルール設定
- **通知設定**: 作業開始/終了時の通知ON/OFF

### 2.3 ユーザーインターフェース
- **最小限の操作**: 基本的に設定後は自動動作
- **拡張機能アイコン**: 現在の作業状況と累計時間をバッジ表示
- **ポップアップUI**: 簡潔な時間表示とクイック設定

## 3. 技術仕様

### 3.1 Chrome拡張機能構成
- **Manifest V3**準拠
- **Content Script**: 各サービスのページ監視
- **Background Script**: 時間計算とデータ管理
- **Popup**: ユーザーインターフェース

### 3.2 データ監視方法
- **DOM変更監視**: MutationObserverでステータス変更を検知
- **URLパターンマッチング**: 対象ページの自動識別
- **ページ遷移追跡**: SPAでの状態変更も対応

### 3.3 データ保存
- **Chrome Storage API**: 設定とタイムログの永続化
- **JSON形式**: 軽量で可読性の高いデータ形式

## 4. ユーザーエクスペリエンス

### 4.1 初期設定フロー
1. Chrome拡張機能をインストール
2. 対象サービス（Backlog/GitHub）を選択
3. 計算対象ステータスを設定（例: "進行中"→"完了"）
4. 通知設定（オプション）

### 4.2 日常的な使用
- **自動動作**: ユーザーが通常通り作業するだけ
- **視覚的フィードバック**: 拡張機能アイコンで現在の状況を表示
- **簡単確認**: ポップアップで今日の作業時間を確認

## 5. 技術的課題と対策

### 5.1 サービス固有の実装
- **Backlog**: APIまたはDOM解析でステータス取得
- **GitHub**: GitHub APIとの連携またはページ解析

### 5.2 精度向上
- **ページ非アクティブ時間の除外**: visibility APIの活用
- **システム休止時間の検知**: タイムスタンプの不整合検知

### 5.3 プライバシー保護
- **ローカル保存**: すべてのデータをユーザーの端末内に保存
- **最小権限**: 必要最小限のサイトアクセス権限のみ要求

## 6. 開発フェーズ

### Phase 1: MVP開発
- Backlogでの基本的な時間計算機能
- シンプルなポップアップUI

### Phase 2: 機能拡張
- GitHub対応
- 詳細レポート機能
- 設定のカスタマイズ性向上

### Phase 3: 最適化
- パフォーマンス改善
- UIの洗練
- エラーハンドリング強化

## 7. 成功指標
- **導入の手軽さ**: 初期設定時間5分以内
- **自動化率**: ユーザー手動操作なしで95%以上の時間を正確に計算
- **パフォーマンス**: ページ読み込み速度への影響1秒以内